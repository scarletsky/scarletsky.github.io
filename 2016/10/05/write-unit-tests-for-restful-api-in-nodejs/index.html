<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>在 Node.js 中为 Restful API 编写单元测试 - scarletsky</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="scarletsky" /><meta name="description" content="简介 单元测试是针对程序模块来进行正确性检验的测试工作，程序单元是应用的最小可测试部件。 在 Web 应用中，我们可以把 Restful API 看作是构成应用的单元。 Restful API 比" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.74.3 with theme even" />


<link rel="canonical" href="https://scarletsky.github.io/2016/10/05/write-unit-tests-for-restful-api-in-nodejs/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.2e81bbed97b8b282c1aeb57488cc71c8d8c8ec559f3931531bd396bf31e0d4dd.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="在 Node.js 中为 Restful API 编写单元测试" />
<meta property="og:description" content="简介 单元测试是针对程序模块来进行正确性检验的测试工作，程序单元是应用的最小可测试部件。 在 Web 应用中，我们可以把 Restful API 看作是构成应用的单元。 Restful API 比" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://scarletsky.github.io/2016/10/05/write-unit-tests-for-restful-api-in-nodejs/" />
<meta property="article:published_time" content="2016-10-05T11:57:26+00:00" />
<meta property="article:modified_time" content="2019-04-30T08:32:59+08:00" />
<meta itemprop="name" content="在 Node.js 中为 Restful API 编写单元测试">
<meta itemprop="description" content="简介 单元测试是针对程序模块来进行正确性检验的测试工作，程序单元是应用的最小可测试部件。 在 Web 应用中，我们可以把 Restful API 看作是构成应用的单元。 Restful API 比">
<meta itemprop="datePublished" content="2016-10-05T11:57:26+00:00" />
<meta itemprop="dateModified" content="2019-04-30T08:32:59+08:00" />
<meta itemprop="wordCount" content="2978">



<meta itemprop="keywords" content="javascript,nodejs," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="在 Node.js 中为 Restful API 编写单元测试"/>
<meta name="twitter:description" content="简介 单元测试是针对程序模块来进行正确性检验的测试工作，程序单元是应用的最小可测试部件。 在 Web 应用中，我们可以把 Restful API 看作是构成应用的单元。 Restful API 比"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">scarletsky.github.io</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">scarletsky.github.io</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">在 Node.js 中为 Restful API 编写单元测试</h1>

      <div class="post-meta">
        <span class="post-time"> 2016-10-05 </span>
        <div class="post-category">
            <a href="/categories/javascript/"> javascript </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#为什么要编写测试">为什么要编写测试</a></li>
<li><a href="#f-i-r-s-t-原则">F.I.R.S.T 原则</a></li>
<li><a href="#编写单元测试">编写单元测试</a></li>
<li><a href="#细节">细节</a>
<ul>
<li><a href="#如何连接测试数据库">如何连接测试数据库</a></li>
<li><a href="#如何清空测试数据库">如何清空测试数据库</a></li>
<li><a href="#何时清空测试环境的数据库">何时清空测试环境的数据库</a></li>
</ul></li>
<li><a href="#参考资料">参考资料</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h2 id="简介">简介</h2>

<p>单元测试是针对程序模块来进行正确性检验的测试工作，程序单元是应用的最小可测试部件。
在 Web 应用中，我们可以把 Restful API 看作是构成应用的单元。
Restful API 比较好测试，测试起来也比较简单。
本文将介绍编写测试的原因和原则，然后以 Node.js 为例子介绍测试 Restful API 的方法。</p>

<h2 id="为什么要编写测试">为什么要编写测试</h2>

<p>每个开发者都知道单元测试的重要性，但并不是每个开发者都会去编写单元测试。原因也很容易理解：</p>

<ul>
<li>编写测试需要更多的时间，会拖慢项目进度</li>
<li>编写测试需要写更多的代码，更容易出现错误</li>
<li>当需求更变后，我们要花更多的精力去修改测试代码</li>
<li>有时候测试代码可能会比源代码多几倍</li>
</ul>

<p>我以前也抱有类似的想法，认为人工测试就足够了，没必要特意去编写单元测试。
然而随着项目的规模的增大，代码也会慢慢出现意外。
最典型的例子是为了某需求修改了 A 位置，需求完成了，而 B 位置就出现了 Bug。</p>

<p>在读过 <a href="http://www.yinwang.org/blog-cn/2016/09/14/tests">王垠大神的《测试的道理》</a> 之后，我更加明白了一个道理：我没有大神般的编码能力，我只能通过单元测试来检验自己的编码。</p>

<p>除了检验代码的正确性之外，我认为单元测试还有一个很重要的作用：为日后重构项目做准备。
只要单元测试覆盖得够好，以后重构的时候就很容易发现问题，节约大量的时间。</p>

<p>轮子哥在 <a href="https://www.zhihu.com/question/28729261/answer/94964928">知乎</a> 上说过一句很有意思的话：
&gt; 所以那些专门写不需要维护的软件的人，讨厌测试，也是情有可原的。</p>

<p>如果你要编写一个长期维护的软件，那么你最好添加单元测试。</p>

<h2 id="f-i-r-s-t-原则">F.I.R.S.T 原则</h2>

<p>当我们决定要编写单元测试之后，我们就要考虑怎样 <strong>写好</strong> 单元测试，换句话说就是编写单元测试时需要注意哪些原则。
那么，有哪些原则是我们需要注意的呢？</p>

<ul>
<li><strong>Fast</strong>: 测试必须是快速的</li>
<li><strong>Isolated / Independent</strong>:

<ul>
<li>每个测试都要做 3 A =&gt; Arrange(准备), Act(行动), Assert(断言)</li>
<li>Arrange: 测试过程中用到的数据不能依赖于运行环境，测试中用到的数据应是测试中的一部分</li>
<li>Act: 调用你想要测试的方法 / API</li>
<li>Assert: 根据返回结果进行断言</li>
<li>测试结果不能依赖运行环境</li>
<li>测试结果不依赖运行测试的顺序</li>
</ul></li>
<li><strong>Repeatable</strong>:

<ul>
<li>每个测试必须是可重复执行的，即运行 N 次，会得到 N 次相同的结果</li>
<li>每个测试的结果不应依赖时间，日期，和随机数的输出</li>
</ul></li>
<li><strong>Self-validating</strong>:

<ul>
<li>每个测试都可以自己判断结果来判断测试是否通过</li>
<li>不需要人类去查阅手册来判断结果</li>
</ul></li>
<li><strong>Thorough and Timely</strong>:

<ul>
<li>应该尽量覆盖所有使用场景</li>
<li>应该尝试测试驱动开发(TDD)</li>
</ul></li>
</ul>

<p>这就是经典的 F.I.R.S.T 原则。
我们最好时刻注意自己编写的单元测试是否遵守这些原则。</p>

<p>JavaScript 社区里有很多测试框架可以用来编写单元测试，有 <code>ava</code>、<code>mocha</code>、<code>jasmine</code>、<code>tap</code> 等。
这些测试框架都有提供 <code>beforeEach</code>、<code>afterEach</code> API，目的是隔离我们的测试数据，从而满足 <strong>Isolated / Independent</strong> 和 <strong>Repeatable</strong> 原则。</p>

<h2 id="编写单元测试">编写单元测试</h2>

<p>假设我们有以下 Restful API (用了 jwt 来做用户验证):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Router</span><span class="p">()</span>
<span class="c1">// 根据 token 获取用户信息，必须登录
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/user&#39;</span><span class="p">,</span> <span class="nx">jwt</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">getSelf</span><span class="p">)</span>
<span class="c1">// 获取用户列表，无需登录
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">getList</span><span class="p">)</span>
<span class="c1">// 获取指定用户信息，无需登录
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/users/:userId&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">get</span><span class="p">)</span>
<span class="c1">// 创建新用户(用户注册)，无需登录
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">create</span><span class="p">)</span>
<span class="c1">// 更新用户信息，必须登录
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;/user&#39;</span><span class="p">,</span> <span class="nx">jwt</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">update</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div>
<p>那么我们应该怎样为这些 Restful API 编写单元测试呢？</p>

<p>最基本流程是：
- 为 app 创建 http 服务器
- 对各个 API 发出请求
- 对响应内容进行断言</p>

<p>幸运的是，社区里已经有相应的工具让我们可以方便管理这个流程，这个工具就是 —— <code>supertest</code>。
它提供了非常灵活的 API，足以帮助我们测试 Restful API 了。
基本用法如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../app&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;supertest&#39;</span><span class="p">)(</span><span class="nx">app</span><span class="p">)</span>

<span class="nx">request</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">end</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">an</span><span class="p">.</span><span class="nb">Array</span><span class="p">()</span>
  <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p>提示
如果你遇到了 <code>TypeError: app.address is not a function</code>, 请尝试一下以下方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;supertest&#39;</span><span class="p">).</span><span class="nx">agent</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>

<p>现在，我们可以把 <code>supertest</code> 和其他测试框架整合起来了，我选择了 <code>mocha</code> 作为例子，因为它很经典，当你会用 <code>mocha</code> 之后，其他测试框架基本上就难不倒你了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">co</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;co&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="p">{</span> <span class="nx">ObjectId</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mongoose&#39;</span><span class="p">).</span><span class="nx">Types</span>
<span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../config&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">UserModel</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../models/user&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../app&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;supertest&#39;</span><span class="p">)(</span><span class="nx">app</span><span class="p">)</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;User API&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

  <span class="c1">// 为每个单元测试初始化数据
</span><span class="c1"></span>  <span class="c1">// 每个单元测试中可以通过 context 来访问相关的数据
</span><span class="c1"></span>  <span class="nx">beforeEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">co</span><span class="p">(</span><span class="kd">function</span><span class="o">*</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">self</span><span class="p">.</span><span class="nx">user1</span> <span class="o">=</span> <span class="k">yield</span> <span class="nx">UserModel</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span> <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;user1&#39;</span> <span class="p">})</span>
      <span class="nx">self</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span> <span class="nx">_id</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">user1</span><span class="p">.</span><span class="nx">_id</span> <span class="p">},</span> <span class="nx">config</span><span class="p">.</span><span class="nx">jwtSecret</span><span class="p">,</span> <span class="p">{</span> <span class="nx">expiresIn</span><span class="o">:</span> <span class="mi">3600</span> <span class="p">})</span>
      <span class="nx">done</span><span class="p">()</span>
    <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;err: &#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
      <span class="nx">done</span><span class="p">()</span>
    <span class="p">})</span>
  <span class="p">})</span>

  <span class="c1">// 正常情况下访问 /user
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should get user info when GET /user with token&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/user&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">token</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">end</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">_id</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">user1</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span>
        <span class="nx">done</span><span class="p">()</span>
      <span class="p">})</span>
  <span class="p">})</span>

  <span class="c1">// 非正常情况下访问 /user
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return 403 when GET /user without token&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/user&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">403</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="c1">// 访问 /users，登录用户和非登录用户都会得到相同的结果，所以不需要区别对待
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return user list when GET /users&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">end</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">an</span><span class="p">.</span><span class="nb">Array</span><span class="p">()</span>
        <span class="nx">done</span><span class="p">()</span>
      <span class="p">})</span>
  <span class="p">})</span>

  <span class="c1">// 访问 /users/:userId 也不需要区分登录和非登录状态
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return user info when GET /users/:userId&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`/users/</span><span class="si">${</span><span class="nx">self</span><span class="p">.</span><span class="nx">user1</span><span class="p">.</span><span class="nx">_id</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">end</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">_id</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">user1</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span>
        <span class="nx">done</span><span class="p">()</span>
      <span class="p">})</span>
  <span class="p">})</span>

  <span class="c1">// 访问不存在的用户，我们需要构造一个虚假的用户 id
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return 404 when GET /users/${non-existent}&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`/users/</span><span class="si">${</span><span class="nx">ObjectId</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="c1">// 正常情况下的用户注册不会带上 token
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return user info when POST /user&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">username</span> <span class="o">=</span> <span class="s1">&#39;test user&#39;</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="nx">username</span><span class="o">:</span> <span class="nx">username</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">end</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">username</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">username</span><span class="p">)</span>
        <span class="nx">done</span><span class="p">()</span>
      <span class="p">})</span>
  <span class="p">})</span>

  <span class="c1">// 非法情况下的用户注册，带上了 token 的请求要判断为非法请求
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return 400 when POST /user with token&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">username</span> <span class="o">=</span> <span class="s1">&#39;test user 2&#39;</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/users&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="nx">username</span><span class="o">:</span> <span class="nx">username</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="c1">// 正常情况下更新用户信息，需要带上 token
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return 200 when PUT /user with token&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;/user&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;valid username&#39;</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="c1">// 非法情况下更新用户信息，如缺少 token
</span><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should return 400 when PUT /user without token&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">request</span>
      <span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;/user&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;valid username&#39;</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span>
  <span class="p">})</span>

<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div>
<p>可以看到，为 Restful API 编写单元测试还有一个优点，就是可以轻易区分登录状态和非登录状态。如果要在用户界面中测试这些功能，那么就需要不停地登录和注销，将会是一项累人的工作~
另外，上面的例子中基本都是对返回状态吗进行断言的，你可以按照自己的需要进行断言。</p>

<blockquote>
<p>提示
你可以选择自己喜欢的断言库，我这里选择了 should.js，原因是好读。
个人认为 should.js 和其他断言库比起来有个缺点，就是不好写。
value.should.xxx.yyy.zzz 这个形式和 assert.equal(value, expected) 相比不太直观。
另外由于 should.js 是通过扩展 Object.prototype 的原型来实现的，但 null 值是一个例外，它不能访问任何属性。
因此 should.js 在 null 上会失效。
一个变通的办法是 <code>(value === null).should.equal(true)</code>。</p>
</blockquote>

<hr />
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ npm <span class="nb">test</span>

  User api
    ✓ should get user info when GET /user with token
    ✓ should <span class="k">return</span> <span class="m">403</span> when GET /user without token
    ✓ should <span class="k">return</span> user list when GET /users
    ✓ should <span class="k">return</span> user info when GET /users/:userId
    ✓ should <span class="k">return</span> <span class="m">404</span> when GET /users/<span class="si">${</span><span class="nv">non</span><span class="p">-existent</span><span class="si">}</span>
    ✓ should <span class="k">return</span> user info when POST /user
    ✓ should <span class="k">return</span> <span class="m">400</span> when POST /user with token
    ✓ should <span class="k">return</span> <span class="m">200</span> when PUT /user with token
    ✓ should <span class="k">return</span> <span class="m">400</span> when PUT /user without token</code></pre></td></tr></table>
</div>
</div>
<p>当我们运行测试时，看到自己编写的测试都通过时，心里都会非常踏实。
而当我们要对项目进行重构时，这些测试用例会帮我们发现重构过程中的问题，减少 Debug 时间，提升重构时的效率。</p>

<h2 id="细节">细节</h2>

<h3 id="如何连接测试数据库">如何连接测试数据库</h3>

<p>在 Node.js 的环境下，我们可以设置环境变量 <code>NODE_ENV=test</code>，然后通过这个环境变量去连接测试数据库，这样测试数据就不会存在于开发环境下的数据库拉！</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// config.js
</span><span class="c1"></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">development</span><span class="o">:</span> <span class="p">{},</span>
  <span class="nx">production</span><span class="o">:</span> <span class="p">{},</span>
  <span class="nx">test</span><span class="o">:</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="c1">// app.js
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">ENV</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">||</span> <span class="s1">&#39;development&#39;</span>
<span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./config&#39;</span><span class="p">)[</span><span class="nx">ENV</span><span class="p">]</span>
<span class="c1">// connect db by config
</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="如何清空测试数据库">如何清空测试数据库</h3>

<p>清空数据库这种一次性的工作最好放到 npm scripts 中处理，需要进行清空操作的时候直接运行 <code>npm run resetDB</code> 就可以了。
需要注意的是，编写清空数据库脚本时必须判断环境变量 <code>NODE_ENV</code>，以免误删 production 环境下的数据。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// resetDB.js
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">env</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">||</span> <span class="s1">&#39;development&#39;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">env</span> <span class="o">===</span> <span class="s1">&#39;test&#39;</span> <span class="o">||</span> <span class="nx">env</span> <span class="o">===</span> <span class="s1">&#39;development&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// connect db and delete data
</span><span class="c1"></span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;You can not run this script in production.&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// package.json
</span><span class="c1"></span><span class="p">{</span>
  <span class="s2">&#34;scripts&#34;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&#34;resetDB&#34;</span><span class="o">:</span> <span class="s2">&#34;node scripts/resetDB.js&#34;</span>
  <span class="p">},</span>
  <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="何时清空测试环境的数据库">何时清空测试环境的数据库</h3>

<p>如果是按照上面的原则来生成测试数据的话，测试数据其实可以不用删掉的。
但由于测试数据会占用我们的空间，最好还是把这些测试数据删掉。
那么，清空测试数据库这个操作在测试前执行好，还是测试后执行好？
我个人倾向于测试前删除，因为有时候我们需要进入数据库，查看测试数据的正确性。
如果在测试后清空测试数据库的话，我们就没办法访问到测试数据了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="s2">&#34;scripts&#34;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&#34;resetDB&#34;</span><span class="o">:</span> <span class="s2">&#34;node scripts/resetDB.js&#34;</span><span class="p">,</span>
    <span class="s2">&#34;test&#34;</span><span class="o">:</span> <span class="s2">&#34;NODE_ENV=test npm run resetDB &amp;&amp; mocha --harmony&#34;</span>
  <span class="p">},</span>
  <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<h2 id="参考资料">参考资料</h2>

<ul>
<li><a href="https://zh.wikipedia.org/zh-cn/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">https://zh.wikipedia.org/zh-cn/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95</a></li>
<li><a href="http://blog.hubstaff.com/why-you-should-write-unit-tests/">http://blog.hubstaff.com/why-you-should-write-unit-tests/</a></li>
<li><a href="http://www.yinwang.org/blog-cn/2016/09/14/tests">http://www.yinwang.org/blog-cn/2016/09/14/tests</a></li>
<li><a href="https://www.zhihu.com/question/28729261/answer/94964928">https://www.zhihu.com/question/28729261/answer/94964928</a></li>
<li><a href="http://agileinaflash.blogspot.de/2009/02/first.html">http://agileinaflash.blogspot.de/2009/02/first.html</a></li>
<li><a href="http://howtodoinjava.com/best-practices/first-principles-for-good-tests/">http://howtodoinjava.com/best-practices/first-principles-for-good-tests/</a></li>
<li><a href="https://github.com/ghsukumar/SFDC_Best_Practices/wiki/F.I.R.S.T-Principles-of-Unit-Testing">https://github.com/ghsukumar/SFDC_Best_Practices/wiki/F.I.R.S.T-Principles-of-Unit-Testing</a></li>
<li><a href="https://github.com/sindresorhus/awesome-nodejs#testing">https://github.com/sindresorhus/awesome-nodejs#testing</a></li>
<li><a href="https://github.com/visionmedia/supertest">https://github.com/visionmedia/supertest</a></li>
<li><a href="https://yq.aliyun.com/articles/57804">https://yq.aliyun.com/articles/57804</a></li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">scarletsky</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2019-04-30
        <a href="/commit/95a170dd24bf4b87af8e8309e95f31f929054a4a" title="chore: format markdown">(95a170d)</a>
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/javascript/">javascript</a>
          <a href="/tags/nodejs/">nodejs</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/2016/11/30/error-handling-in-restful-api/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Restful API 中的错误处理</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/2016/09/11/talking-about-front-end-pagination-implementation-in-spa/">
            <span class="next-text nav-default">浅谈单页应用中前端分页的实现方案</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="scarletsky/scarletsky.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:scarletsky1025@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/scarletsky" class="iconfont icon-github" title="github"></a>
  <a href="https://scarletsky.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>scarletsky</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
